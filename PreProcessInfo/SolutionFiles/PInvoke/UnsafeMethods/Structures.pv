(%unit (%imports (%import "System") (%import "System.Runtime.InteropServices") (%import "System.Drawing") (%import "UpgradeHelpers.Helpers")) (%package "UnsafeNative") (%module (%attribute-list (%attribute (%id "System.Security.SuppressUnmanagedCodeSecurity"))) "Structures" (%public) (%structure (%attribute-list (%attribute (%id "Serializable")) (%attribute (%call (%id "StructLayout") (%param (%id "LayoutKind.Sequential"))))) (%public) "tagHH_FTS_QUERY" (%variable-list (%variable (%var "cbStruct") (%int))) (%variable-list (%variable (%var "fUniCodeStrings") (%int))) (%variable-list (%variable (%var "pszSearchQuery") (%string))) (%variable-list (%variable (%var "iProximity") (%int))) (%variable-list (%variable (%var "fStemmedSearch") (%int))) (%variable-list (%variable (%var "fTitleOnly") (%int))) (%variable-list (%variable (%var "fExecute") (%int))) (%variable-list (%variable (%var "pszWindow") (%string))) (%method "InitStruct" (%void) (%args (%variable (%byref) (%var "result") (%user-type "tagHH_FTS_QUERY")) (%variable (%byval) (%var "init") (%boolean))) (%seq (%if (%id "init") (%seq (%= (%dot (%id "result") (%id "pszSearchQuery")) (%id "String.Empty")) (%= (%dot (%id "result") (%id "pszWindow")) (%id "String.Empty"))))) (%private) (%shared)) (%method "CreateInstance" (%user-type "tagHH_FTS_QUERY") (%args) (%seq (%variable-list (%variable (%var "result") (%new (%user-type "tagHH_FTS_QUERY")))) (%call (%id "InitStruct") (%param (%id "result") (%true))) [%return (%id "result")]) (%public) (%shared)) (%method "Clone" (%user-type "tagHH_FTS_QUERY") (%args) (%seq (%variable-list (%variable (%var "result" (%init-value (%this))) (%user-type "tagHH_FTS_QUERY"))) (%call (%id "InitStruct") (%param (%id "result") (%false))) [%return (%id "result")]) (%public))) (%structure (%attribute-list (%attribute (%id "Serializable")) (%attribute (%call (%id "StructLayout") (%param (%id "LayoutKind.Sequential"))))) (%public) "MSGBOXPARAMS" (%variable-list (%variable (%var "cbSize") (%int))) (%variable-list (%variable (%var "hWndOwner") (%int))) (%variable-list (%variable (%var "hInstance") (%int))) (%variable-list (%variable (%var "lpszText") (%string))) (%variable-list (%variable (%var "lpszCaption") (%string))) (%variable-list (%variable (%var "dwStyle") (%int))) (%variable-list (%variable (%var "lpszIcon") (%string))) (%variable-list (%variable (%var "dwContextHelpId") (%int))) (%variable-list (%variable (%var "lpfnMsgBoxCallback") (%int))) (%variable-list (%variable (%var "dwLanguageId") (%int))) (%method "InitStruct" (%void) (%args (%variable (%byref) (%var "result") (%user-type "MSGBOXPARAMS")) (%variable (%byval) (%var "init") (%boolean))) (%seq (%if (%id "init") (%seq (%= (%dot (%id "result") (%id "lpszText")) (%id "String.Empty")) (%= (%dot (%id "result") (%id "lpszCaption")) (%id "String.Empty")) (%= (%dot (%id "result") (%id "lpszIcon")) (%id "String.Empty"))))) (%private) (%shared)) (%method "CreateInstance" (%user-type "MSGBOXPARAMS") (%args) (%seq (%variable-list (%variable (%var "result") (%new (%user-type "MSGBOXPARAMS")))) (%call (%id "InitStruct") (%param (%id "result") (%true))) [%return (%id "result")]) (%public) (%shared)) (%method "Clone" (%user-type "MSGBOXPARAMS") (%args) (%seq (%variable-list (%variable (%var "result" (%init-value (%this))) (%user-type "MSGBOXPARAMS"))) (%call (%id "InitStruct") (%param (%id "result") (%false))) [%return (%id "result")]) (%public))) (%structure (%attribute-list (%attribute (%id "Serializable")) (%attribute (%call (%id "StructLayout") (%param (%id "LayoutKind.Sequential"))))) (%public) "tagHH_POPUP" (%variable-list (%variable (%var "cbStruct") (%short))) (%variable-list (%variable (%var "hinst") (%int))) (%variable-list (%variable (%var "idString") (%int))) (%variable-list (%variable (%var "pszText") (%string))) (%variable-list (%variable (%var "pt") (%user-type "BT2Support.UnsafeNative.Structures.POINTAPI"))) (%variable-list (%variable (%var "clrForeground") (%user-type "Color"))) (%variable-list (%variable (%var "clrBackground") (%user-type "Color"))) (%variable-list (%variable (%var "rcMargins") (%user-type "BT2Support.UnsafeNative.Structures.RECT"))) (%variable-list (%variable (%var "pszFont") (%string))) (%method "InitStruct" (%void) (%args (%variable (%byref) (%var "result") (%user-type "tagHH_POPUP")) (%variable (%byval) (%var "init") (%boolean))) (%seq (%if (%id "init") (%seq (%= (%dot (%id "result") (%id "pszText")) (%id "String.Empty")) (%= (%dot (%id "result") (%id "pszFont")) (%id "String.Empty"))))) (%private) (%shared)) (%method "CreateInstance" (%user-type "tagHH_POPUP") (%args) (%seq (%variable-list (%variable (%var "result") (%new (%user-type "tagHH_POPUP")))) (%call (%id "InitStruct") (%param (%id "result") (%true))) [%return (%id "result")]) (%public) (%shared)) (%method "Clone" (%user-type "tagHH_POPUP") (%args) (%seq (%variable-list (%variable (%var "result" (%init-value (%this))) (%user-type "tagHH_POPUP"))) (%call (%id "InitStruct") (%param (%id "result") (%false))) [%return (%id "result")]) (%public))) (%structure (%attribute-list (%attribute (%id "Serializable")) (%attribute (%call (%id "StructLayout") (%param (%id "LayoutKind.Sequential"))))) (%public) "POINTAPI" (%variable-list (%variable (%var "x") (%int))) (%variable-list (%variable (%var "y") (%int)))) (%structure (%attribute-list (%attribute (%id "Serializable")) (%attribute (%call (%id "StructLayout") (%param (%id "LayoutKind.Sequential") (%attribute-object-initializer (%id "CharSet") (%id "CharSet.Ansi")))))) (%public) "WIN32_FIND_DATA" (%variable-list (%variable (%var "dwFileAttributes") (%int))) (%variable-list (%variable (%var "ftCreationTime") (%user-type "BT2Support.UnsafeNative.Structures.FILETIME"))) (%variable-list (%variable (%var "ftLastAccessTime") (%user-type "BT2Support.UnsafeNative.Structures.FILETIME"))) (%variable-list (%variable (%var "ftLastWriteTime") (%user-type "BT2Support.UnsafeNative.Structures.FILETIME"))) (%variable-list (%variable (%var "nFileSizeHigh") (%int))) (%variable-list (%variable (%var "nFileSizeLow") (%int))) (%variable-list (%variable (%var "dwReserved0") (%int))) (%variable-list (%variable (%var "dwReserved1") (%int))) (%variable-list (%attribute-list (%attribute (%call (%id "Microsoft.VisualBasic.VBFixedArray") (%param 259))) (%attribute (%call (%id "System.Runtime.InteropServices.MarshalAs") (%param (%id "System.Runtime.InteropServices.UnmanagedType.ByValArray") (%attribute-object-initializer (%id "SizeConst") 260))))) (%private) (%variable (%var "_cFileName") (%array (%dimension-value) (%char)))) (%variable-list (%attribute-list (%attribute (%call (%id "Microsoft.VisualBasic.VBFixedArray") (%param 13))) (%attribute (%call (%id "System.Runtime.InteropServices.MarshalAs") (%param (%id "System.Runtime.InteropServices.UnmanagedType.ByValArray") (%attribute-object-initializer (%id "SizeConst") 14))))) (%private) (%variable (%var "_cAlternate") (%array (%dimension-value) (%char)))) (%property (%public) "cFileName" (%string) (%args) (%get-property (%seq [%return (%new (%string) (%param (%id "_cFileName")))])) (%set-property (%args (%variable (%byval) (%var "Value") (%string))) (%seq (%call (%id "ArraysHelper.CopyStringToCharArray") (%param (%id "_cFileName") (%id "Value")))))) (%property (%public) "cAlternate" (%string) (%args) (%get-property (%seq [%return (%new (%string) (%param (%id "_cAlternate")))])) (%set-property (%args (%variable (%byval) (%var "Value") (%string))) (%seq (%call (%id "ArraysHelper.CopyStringToCharArray") (%param (%id "_cAlternate") (%id "Value")))))) (%method "InitStruct" (%void) (%args (%variable (%byref) (%var "result") (%user-type "WIN32_FIND_DATA")) (%variable (%byval) (%var "init") (%boolean))) (%seq (%redim (%id "result._cFileName") (%array (%dimension-value 259))) (%redim (%id "result._cAlternate") (%array (%dimension-value 13)))) (%private) (%shared)) (%method "CreateInstance" (%user-type "WIN32_FIND_DATA") (%args) (%seq (%variable-list (%variable (%var "result") (%new (%user-type "WIN32_FIND_DATA")))) (%call (%id "InitStruct") (%param (%id "result") (%true))) [%return (%id "result")]) (%public) (%shared)) (%method "Clone" (%user-type "WIN32_FIND_DATA") (%args) (%seq (%variable-list (%variable (%var "result" (%init-value (%this))) (%user-type "WIN32_FIND_DATA"))) (%call (%id "InitStruct") (%param (%id "result") (%false))) (%call (%id "Array.Copy") (%param (%dot (%this) (%id "_cFileName")) (%dot (%id "result") (%id "_cFileName")) 260)) (%call (%id "Array.Copy") (%param (%dot (%this) (%id "_cAlternate")) (%dot (%id "result") (%id "_cAlternate")) 14)) [%return (%id "result")]) (%public))) (%structure (%attribute-list (%attribute (%id "Serializable")) (%attribute (%call (%id "StructLayout") (%param (%id "LayoutKind.Sequential"))))) (%public) "RECT" (%variable-list (%variable (%var "Left") (%int))) (%variable-list (%variable (%var "Top") (%int))) (%variable-list (%variable (%var "Right") (%int))) (%variable-list (%variable (%var "Bottom") (%int)))) (%structure (%attribute-list (%attribute (%id "Serializable")) (%attribute (%call (%id "StructLayout") (%param (%id "LayoutKind.Sequential"))))) (%public) "FILETIME" (%variable-list (%variable (%var "dwLowDateTime") (%int))) (%variable-list (%variable (%var "dwHighDateTime") (%int)))) (%structure (%attribute-list (%attribute (%id "Serializable")) (%attribute (%call (%id "StructLayout") (%param (%id "LayoutKind.Sequential"))))) (%public) "SECURITY_ATTRIBUTES" (%variable-list (%variable (%var "nLength") (%int))) (%variable-list (%variable (%var "lpSecurityDescriptor") (%int))) (%variable-list (%variable (%var "bInheritHandle") (%int)))) (%structure (%attribute-list (%attribute (%id "Serializable")) (%attribute (%call (%id "StructLayout") (%param (%id "LayoutKind.Sequential"))))) (%public) "tagHH_AKLINK" (%variable-list (%variable (%var "cbStruct") (%int))) (%variable-list (%variable (%var "fReserved") (%boolean))) (%variable-list (%variable (%var "pszKeywords") (%string))) (%variable-list (%variable (%var "pszUrl") (%string))) (%variable-list (%variable (%var "pszMsgText") (%string))) (%variable-list (%variable (%var "pszMsgTitle") (%string))) (%variable-list (%variable (%var "pszWindow") (%string))) (%variable-list (%variable (%var "fIndexOnFail") (%boolean))) (%method "InitStruct" (%void) (%args (%variable (%byref) (%var "result") (%user-type "tagHH_AKLINK")) (%variable (%byval) (%var "init") (%boolean))) (%seq (%if (%id "init") (%seq (%= (%dot (%id "result") (%id "pszKeywords")) (%id "String.Empty")) (%= (%dot (%id "result") (%id "pszUrl")) (%id "String.Empty")) (%= (%dot (%id "result") (%id "pszMsgText")) (%id "String.Empty")) (%= (%dot (%id "result") (%id "pszMsgTitle")) (%id "String.Empty")) (%= (%dot (%id "result") (%id "pszWindow")) (%id "String.Empty"))))) (%private) (%shared)) (%method "CreateInstance" (%user-type "tagHH_AKLINK") (%args) (%seq (%variable-list (%variable (%var "result") (%new (%user-type "tagHH_AKLINK")))) (%call (%id "InitStruct") (%param (%id "result") (%true))) [%return (%id "result")]) (%public) (%shared)) (%method "Clone" (%user-type "tagHH_AKLINK") (%args) (%seq (%variable-list (%variable (%var "result" (%init-value (%this))) (%user-type "tagHH_AKLINK"))) (%call (%id "InitStruct") (%param (%id "result") (%false))) [%return (%id "result")]) (%public))) (%structure (%attribute-list (%attribute (%id "Serializable")) (%attribute (%call (%id "StructLayout") (%param (%id "LayoutKind.Sequential") (%attribute-object-initializer (%id "CharSet") (%id "CharSet.Ansi")))))) (%public) "OSVERSIONINFO" (%variable-list (%variable (%var "dwOSVersionInfoSize") (%int))) (%variable-list (%variable (%var "dwMajorVersion") (%int))) (%variable-list (%variable (%var "dwMinorVersion") (%int))) (%variable-list (%variable (%var "dwBuildNumber") (%int))) (%variable-list (%variable (%var "dwPlatformId") (%int))) (%variable-list (%attribute-list (%attribute (%call (%id "Microsoft.VisualBasic.VBFixedArray") (%param 127))) (%attribute (%call (%id "System.Runtime.InteropServices.MarshalAs") (%param (%id "System.Runtime.InteropServices.UnmanagedType.ByValArray") (%attribute-object-initializer (%id "SizeConst") 128))))) (%private) (%variable (%var "_szCSDVersion") (%array (%dimension-value) (%char)))) (%property (%public) "szCSDVersion" (%string) (%args) (%get-property (%seq [%return (%new (%string) (%param (%id "_szCSDVersion")))])) (%set-property (%args (%variable (%byval) (%var "Value") (%string))) (%seq (%call (%id "ArraysHelper.CopyStringToCharArray") (%param (%id "_szCSDVersion") (%id "Value")))))) (%method "InitStruct" (%void) (%args (%variable (%byref) (%var "result") (%user-type "OSVERSIONINFO")) (%variable (%byval) (%var "init") (%boolean))) (%seq (%redim (%id "result._szCSDVersion") (%array (%dimension-value 127)))) (%private) (%shared)) (%method "CreateInstance" (%user-type "OSVERSIONINFO") (%args) (%seq (%variable-list (%variable (%var "result") (%new (%user-type "OSVERSIONINFO")))) (%call (%id "InitStruct") (%param (%id "result") (%true))) [%return (%id "result")]) (%public) (%shared)) (%method "Clone" (%user-type "OSVERSIONINFO") (%args) (%seq (%variable-list (%variable (%var "result" (%init-value (%this))) (%user-type "OSVERSIONINFO"))) (%call (%id "InitStruct") (%param (%id "result") (%false))) (%call (%id "Array.Copy") (%param (%dot (%this) (%id "_szCSDVersion")) (%dot (%id "result") (%id "_szCSDVersion")) 128)) [%return (%id "result")]) (%public)))))